<h1>商品一覧</h1>
<%= form_with(model: @stock, local: true, url: new_order_path(@stocks), method: :get) do |f| %>
<%= h(flash[:notice]) %><br>
<%= h(flash[:notice2]) %>
<% if @current_user.id == 1 %>
<p><%=link_to "在庫登録（user_id:1のみ表示)", new_stock_path %></p>
<%= params %>
<% end %>


  <table>
    <tr>
        <th>商品名</th>
        <th>価格(peso)</th>
        <th>説明</th>
        <th>注文個数</th>
    </tr>
  <tr>

  <% @stocks.each do |stock| %>
    <% if stock.quantity_of_stock > 0 %>
    <td><%= stock.goods_master.goods_name %></td>
    <td><%= stock.goods_master.price %></td>
    <td><%= stock.goods_master.about %></td>
    <td hidden><%=f.hidden_field :"user_id[]", value: "#{@current_user.id}" %></td>
    <td hidden><%=f.hidden_field :"goods_name[]", value: "#{stock.goods_master.goods_name}" %></td>
    <td hidden><%=f.hidden_field :"price[]", value: "#{stock.goods_master.price}" %></td>
    <td hidden><%=f.hidden_field :"goods_master_id[]", value: "#{stock.goods_master.id}" %></td>
    <td hidden><%=f.hidden_field :"about[]", value: "#{stock.goods_master.about}" %></td>
    <td>
    <% if params[:amount] %>
    <%=f.number_field :"amount[]",value:
    params[:amount][params[:goods_master_id].index("#{stock.goods_master.id}")]
    %>
    <% else %>
    <%=f.number_field :"amount[]" 
    %>
    <% end %>
    </td>

    <% end %>
  </tr>
  <% end %>
  
</table>

<td><%=f.submit %></td>
<% if params[:orders] %>
<p>「注文する商品を選択してください」</p>
<% end %>
  <% end %>


